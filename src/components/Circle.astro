---
export interface Props {
  color: "orange" | "green" | "blue";
  percentage: number;
  desc: { title: string; text: string };
  text?: string | number;
}

let { color, percentage, text, desc } = Astro.props as Props;
text = text !== undefined ? text : percentage;
---

<div class="single-chart">
  <svg viewBox="0 0 36 36" class={`circular-chart ${color}`}>
    <path
      class="circle-bg"
      d="M18 2.0845
          a 15.9155 15.9155 0 0 1 0 31.831
          a 15.9155 15.9155 0 0 1 0 -31.831"
    ></path>
    <path
      class="circle"
      stroke-dasharray={`${percentage}, 100`}
      d="M18 2.0845
          a 15.9155 15.9155 0 0 1 0 31.831
          a 15.9155 15.9155 0 0 1 0 -31.831"
    ></path>
    <text x="18" y="20.35" class="percentage">{text}%</text>
  </svg>
  <!-- TODO: USE BUILT-IN CLASSES -->
  <div class="desc">
    <h5 class={`title ${color}`}>{desc.title}</h5>
    <p>{desc.text}</p>
  </div>
</div>

<style>
  .desc {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .single-chart {
    width: 22%;
    justify-content: space-around;
  }

  .circular-chart {
    display: block;
    margin: 10px auto;
    max-width: 80%;
    max-height: 250px;
    margin-bottom: 20px;
  }

  .circle-bg {
    fill: none;
    stroke: #eee;
    stroke-width: 3.8;
  }

  .circle {
    fill: none;
    stroke-width: 2.8;
    stroke-linecap: round;
  }

  .animate {
    animation: progress 1.5s ease-out forwards;
  }

  @keyframes progress {
    0% {
      stroke-dasharray: 0 100;
    }
  }
  .circular-chart.green .circle {
    stroke: var(--row-2);
  }

  .circular-chart.orange .circle {
    stroke: var(--row-4);
  }

  .circular-chart.blue .circle {
    stroke: var(--row-7);
  }

  .title.green {
    color: var(--row-2);
  }

  .title.orange {
    color: var(--row-4);
  }

  .title.blue {
    color: var(--row-7);
  }

  .percentage {
    fill: #666;
    font-family: sans-serif;
    font-size: 0.5em;
    text-anchor: middle;
  }

  @media only screen and (max-width: 1120px) {
    .single-chart {
      width: 48%;
      justify-content: space-around;
      margin-bottom: 30px;
    }
  }

  @media only screen and (max-width: 425px) {
    .single-chart {
      width: 100%;
    }
  }
</style>
